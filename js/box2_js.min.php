<?php
if (!empty($_POST['link'])){
?>
<script type="text/javascript">
function move(){var t=document.getElementById("myBar"),a=1,e=setInterval(function(){a>=100?(clearInterval(e),$("#tablebox2").show(),$("#myBar").hide()):(a++,t.style.width=a+"%",$("#tablebox2").hide(),$("#myBar").show())},10)}function hitungbox2(){var t=document.getElementById("lbrcetakbox2").value,a=document.getElementById("tgcetakbox2").value,e=document.getElementById("pjcetakbox2").value,n=document.getElementById("lbrtutupbox2").value;lbrcetak=parseFloat(e)+2*parseFloat(a)+2*parseFloat(n),tgcetak=2*parseFloat(a)+2*parseFloat(t)+parseFloat(1.5);var o=document.getElementById("jmlcetakbox2").value,l=document.getElementById("bahanbox2").value,i=document.getElementById("bbbox2").value,r=document.getElementById("jmlwarnabox21").value,d=document.getElementById("jmlwarnabox22").value;if("Full Color"==r&&(r=4),null!=r&&r<1)alert("Jumlah Warna Minimal 1!!");else{var s,p,m=document.getElementById("lambox2").value,u=1,b=1,c=1,g=1,f=1,h=1,k=1,y=1,v=0,x=0,I=0,j=0,B=0,E=0,w=0,_=document.getElementById("ketbox2").value,M=$("#idmesin").val(),F=$("#idkertas").val();if(s=lbrcetak/o,p=tgcetak,"12","13",1==document.getElementById("pond"+mod).checked&&(lbrpondoffset=document.getElementById("lbrpond"+mod).value,tgpondoffset=document.getElementById("tgpond"+mod).value,w="12",k=lbrpondoffset,y=tgpondoffset,E="13",v=lbrpondoffset/o,x=tgpondoffset),1==document.getElementById("finishing4box2").checked&&(j="19",c=lbrcetak,g=tgcetak),1==document.getElementById("finishing1box2").checked&&(lbrpolykop=document.getElementById("lbrpolybox2").value,tgpolykop=document.getElementById("tgpolybox2").value,B="10",f=lbrpolykop,h=tgpolykop,I="11",u=lbrpolykop/o,b=tgpolykop),null!=o&&o<1)alert("Jumlah Cetakan Kosong!!");else if(null!=lbrcetak&&lbrcetak<1)alert(" Lebar Cetakan Kosong!!");else if(null!=tgcetak&&tgcetak<1)alert("Tinggi Cetakan Kosong!!");else{var C=new XMLHttpRequest;C.onreadystatechange=function(){if(4==C.readyState&&200==C.status)if(myArr=JSON.parse(C.responseText),data=myArr,$("#tablbox2").length){$("#tablbox2 tr:gt(0)").remove();var t=$("#tablbox2").children(),a=0;for(n=0;n<data.length;n++){"Y"==data[n].ongpot&&(a=data[n].ongkos_potong),totalk=parseInt(data[n].totcetak)+parseInt(data[n].totbhn)+parseInt(a)+parseInt(data[n].tot_ctp)+parseInt(data[n].totlaminating)+parseInt(data[n].finishing1)+parseInt(data[n].finishing2)+parseInt(data[n].finishing3)+parseInt(data[n].finishing4)+parseInt(data[n].finishing5)+parseInt(data[n].finishing6)+parseInt(data[n].finishing7)+parseInt(data[n].finishing8),profit=data[n].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/o/1,perrim=500*satuan;var e=btoa(encodeURIComponent(JSON.stringify(data[n])));l+="<tr class='text-md-left p-0'><td>"+data[n].mesin+"</td><td class='text-md-right' >Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim <input type='hidden' name='jumlahcetak' value='"+o+"' /><input type='hidden' name='ket' value='"+_+"' /><input type='hidden' name='data1[]' value='"+e+"' /><button type='submit' name='submit' value='"+[n]+"' class='btn btn-warning btn-sm' style='background-color:#ff8000;color:white;width:120px'>Rp."+formatMoney(jual)+"</button></td></tr>"}t.append(l)}else{$("#tablebox2").append("<div id='detailbox2' class='small'><table id='tablbox2' class='table table-striped mb-0' ><thead ><tr style='background-color:<?= $warnabar; ?>;color:black' ><th class='text-md-left'>Mesin</th><th class='text-md-right'>Harga</th></tr></thead></table></div>");var n,l;t=$("#tablbox2").children(),a=0;for(n=0;n<data.length;n++){"Y"==data[n].ongpot&&(a=data[n].ongkos_potong),totalk=parseInt(data[n].totcetak)+parseInt(data[n].totbhn)+parseInt(a)+parseInt(data[n].tot_ctp)+parseInt(data[n].totlaminating)+parseInt(data[n].finishing1)+parseInt(data[n].finishing2)+parseInt(data[n].finishing3)+parseInt(data[n].finishing4)+parseInt(data[n].finishing5)+parseInt(data[n].finishing6)+parseInt(data[n].finishing7)+ +parseInt(data[n].finishing8),profit=data[n].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/o/1,perrim=500*satuan;e=btoa(encodeURIComponent(JSON.stringify(data[n])));l+="<tr class='text-left'><td>"+data[n].mesin+"</td><td class='text-md-right' >Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim <button type='submit' name='submit' value='"+[n]+"' class='btn btn-warning btn-sm' style='background-color:#ff8000;color:white;width:120px'>Rp."+formatMoney(jual)+"</button></td><input type='hidden' name='jumlahcetak' value='"+o+"' /><input type='hidden' name='ket' value='"+_+"' /><input type='hidden' name='data1[]' value='"+e+"' /></tr>"}t.append(l)}};var R="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+o+"&bahan="+l+"&bb="+i+"&jmlwarna="+r+"&jmlwarna2="+d+"&lam="+m+"&finishing1="+I+"&finishing2=12&finishing3=13&finishing4="+j+"&finishing5="+B+"&finishing6=0&finishing7="+E+"&finishing8="+w+"&lbrf1="+u+"&tgf1="+b+"&lbrf2=1&tgf2=1&lbrf3="+s+"&tgf3="+p+"&lbrf4="+c+"&tgf4="+g+"&lbrf5="+f+"&tgf5="+h+"&lbrf6="+k+"&tgf6="+y+"&lbrf7="+v+"&tgf7="+x+"&jmlset=1&modul=box2&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=pcs&ongpot=N&j_mesin=&idmesin="+M+"&idkertas="+F+"&app_id="+app_id,K=host+"/sandbox/get/";C.open("POST",K,!0),C.setRequestHeader("Content-type","application/x-www-form-urlencoded"),C.send(R)}}}CustomStyle(),$("#finishing1"+mod).click(function(){$(this).is(":checked")?($("#lbrpoly"+mod).removeAttr("readonly"),$("#tgpoly"+mod).removeAttr("readonly")):($("#lbrpoly"+mod).attr("readonly",!0),$("#tgpoly"+mod).attr("readonly",!0),$("#lbrpoly"+mod).val(1),$("#tgpoly"+mod).val(1))}),$("#pond"+mod).click(function(){$(this).is(":checked")?($("#lbrpond"+mod).removeAttr("readonly"),$("#tgpond"+mod).removeAttr("readonly")):($("#lbrpond"+mod).attr("readonly",!0),$("#tgpond"+mod).attr("readonly",!0),$("#lbrpond"+mod).val(0),$("#tgpond"+mod).val(0))}),$("#idmesin").filter(function(){$("select[data-mesin]").each(function(){var t=$(this);t.append('<option value="0">Pilih mesin</option>'),$.ajax({url:t.attr("data-mesin")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$("#bahanbox2").filter(function(){$("select[data-source]").each(function(){var t=$(this);t.append('<option value="0">Pilih jenis</option>'),$.ajax({url:t.attr("data-source")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$("#bahan"+mod).change(function(){var t=$(this).val();$.ajax({url:host+"/kertas/",type:"post",data:{depart:t,app_id:app_id},dataType:"json",success:function(t){var a=t.length;$("#idkertas").empty();for(var e=0;e<a;e++){var n=t[e].id,o=t[e].name;$("#idkertas").append("<option value='"+n+"'>"+o+"</option>")}}})}),$(".harga").hide(),$(".printpenawaran").hide(),$(".alert").hide(),$(".btnon, .btnd, .btnp").prop("disabled",!0),$("#jmlcetakbox2").keypress(validateNumber),$("#jmlcetakbox2").keyup(function(){$(".btnon,.btnd,.btnp").prop("disabled",""==this.value)}),$("#ket"+mod).keyup(function(){$(".btnon").prop("disabled",""==this.value)}),$("#lbrcetakbox2").val("10"),$("#tgcetakbox2").val("8"),$("#pjcetakbox2").val("20"),$("#bbbox2").val("1"),$("#lbrtutupbox2").val("1.5"),$("#bx2").click(function(){$("#detailbox2").length&&$("#detailbox2").remove(),$("#detailkertasbox2").length&&$("#detailkertasbox2").remove()}),$("#cekukuranbox2").click(function(){CustomStyle();var t=$("#jmlcetakbox2").val(),a=$("#idmesin").val(),e=$("#bahanbox2").val();if(""==t)salert("warning","Oops...",iMsg.J+" Cetakan Kosong!!");else if(0==a)salert("warning","Oops...",iMsg.M+" belum dipilih!!");else if(0==e)salert("warning","Oops...",iMsg.B+" belum dipilih!!");else{var n=document.getElementById("lbrcetakbox2").value,o=document.getElementById("tgcetakbox2").value,l=document.getElementById("pjcetakbox2").value,i=document.getElementById("lbrtutupbox2").value;lbrcetak=parseFloat(l)+2*parseFloat(o),tgcetak=2*parseFloat(o)+2*parseFloat(n)+parseFloat(i),$.ajax({url:host+"/cek/cekukuran/",type:"POST",data:{mesin:a,lbrcetak:lbrcetak,tgcetak:tgcetak,app_id:app_id},dataType:"json",success:function(t){"N"==t[0].toString()?alert("Ukuran Kebesaran"):(move(),hitungbox2())}})}});
</script>
<?php
} //end token
else {
	echo json_encode(array(404 => "error"));
}
?>