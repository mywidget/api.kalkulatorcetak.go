<?php
if (!empty($_POST['link'])){
?>
<script type="text/javascript">
function move(){var t=document.getElementById("myBar"),a=1,e=setInterval(function(){a>=100?(clearInterval(e),$("#tablebox3").show(),$("#myBar").hide()):(a++,t.style.width=a+"%",$("#tablebox3").hide(),$("#myBar").show())},10)}function hitungbox3(){move();var t=document.getElementById("lbrcetakbox3").value,a=document.getElementById("tgcetakbox3").value,e=document.getElementById("pjcetakbox3").value,n=document.getElementById("lbrtutupbox3").value;lbrcetak=2*parseFloat(t)+2*parseFloat(a)+parseFloat(1.5),tgcetak=parseFloat(a)+parseFloat(e)+.75*parseFloat(a)+parseFloat(n);var o=document.getElementById("jmlcetakbox3").value,r=document.getElementById("bahanbox3").value,l=document.getElementById("bbbox3").value,i=document.getElementById("jmlwarnabox31").value,d=document.getElementById("jmlwarnabox32").value;if("Full Color"==i&&(i=4),null!=i&&i<1)alert("Jumlah Warna Minimal 1!!");else{var s,p,m=document.getElementById("lambox3").value,u=1,b=1,c=1,g=1,h=1,f=1,k=1,y=1,v=0,x=0,I=0,j=0,w=0,B=0,E=0,M=document.getElementById("ketbox3").value,F=$("#idmesin").val(),_=$("#idkertas").val();if(s=lbrcetak/o,p=tgcetak,"12","13",1==document.getElementById("pond"+mod).checked&&(lbrpondoffset=document.getElementById("lbrpond"+mod).value,tgpondoffset=document.getElementById("tgpond"+mod).value,E="12",k=lbrpondoffset,y=tgpondoffset,B="13",v=lbrpondoffset/o,x=tgpondoffset),1==document.getElementById("finishing4box3").checked&&(j="19",c=lbrcetak,g=tgcetak),1==document.getElementById("finishing1box3").checked&&(lbrpolykop=document.getElementById("lbrpolybox3").value,tgpolykop=document.getElementById("tgpolybox3").value,w="10",h=lbrpolykop,f=tgpolykop,I="11",u=lbrpolykop/o,b=tgpolykop),null!=o&&o<1)alert("Jumlah Cetakan Kosong!!");else if(null!=lbrcetak&&lbrcetak<1)alert(" Lebar Cetakan Kosong!!");else if(null!=tgcetak&&tgcetak<1)alert("Tinggi Cetakan Kosong!!");else{var O=new XMLHttpRequest;O.onreadystatechange=function(){if(4==O.readyState&&200==O.status)if(myArr=JSON.parse(O.responseText),data=myArr,$("#tablbox3").length){$("#tablbox3 tr:gt(0)").remove();var t,a=$("#tablbox3").children(),e=0;for(r=0;r<data.length;r++){"Y"==data[r].ongpot&&(e=data[r].ongkos_potong),totalk=parseInt(data[r].totcetak)+parseInt(data[r].totbhn)+parseInt(e)+parseInt(data[r].tot_ctp)+parseInt(data[r].totlaminating)+parseInt(data[r].finishing1)+parseInt(data[r].finishing2)+parseInt(data[r].finishing3)+parseInt(data[r].finishing4)+parseInt(data[r].finishing5)+parseInt(data[r].finishing6)+parseInt(data[r].finishing7)+ +parseInt(data[r].finishing8),profit=data[r].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/o/1,o>500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs");var n=btoa(encodeURIComponent(JSON.stringify(data[r])));t+="<tr class='text-md-left'><td>"+data[r].mesin+"</td><td class='text-md-right' >"+perrim+"<button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button></td><input type='hidden' name='jumlahcetak' value='"+o+"' /><input type='hidden' name='ket' value='"+M+"' /><input type='hidden' name='data1[]' value='"+n+"' /></tr>"}a.append(t)}else{$("#tablebox3").append("<div id='detailbox3' class='small'><table id='tablbox3' class='table table-striped' ><thead ><tr style='background-color:<?= $warnabar; ?>;color:white' ><th  class='text-md-left' style='width:30%'>Mesin</th><th class='text-md-right'>Harga</th></tr></thead></table></div>");var r;a=$("#tablbox3").children(),e=0;for(r=0;r<data.length;r++){"Y"==data[r].ongpot&&(e=data[r].ongkos_potong),totalk=parseInt(data[r].totcetak)+parseInt(data[r].totbhn)+parseInt(e)+parseInt(data[r].tot_ctp)+parseInt(data[r].totlaminating)+parseInt(data[r].finishing1)+parseInt(data[r].finishing2)+parseInt(data[r].finishing3)+parseInt(data[r].finishing4)+parseInt(data[r].finishing5)+parseInt(data[r].finishing6)+parseInt(data[r].finishing7)+ +parseInt(data[r].finishing8),profit=data[r].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/o/1,perrim=500*satuan,o>500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs ");n=btoa(encodeURIComponent(JSON.stringify(data[r])));t+="<tr class='text-md-left'><td>"+data[r].mesin+"</td><td class='text-md-right' >"+perrim+"<button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button></td><input type='hidden' name='jumlahcetak' value='"+o+"' /><input type='hidden' name='ket' value='"+M+"' /><input type='hidden' name='data1[]' value='"+n+"' /></tr>"}a.append(t)}};var R="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+o+"&bahan="+r+"&bb="+l+"&jmlwarna="+i+"&jmlwarna2="+d+"&lam="+m+"&finishing1="+I+"&finishing2=12&finishing3=13&finishing4="+j+"&finishing5="+w+"&finishing6=0&finishing7="+B+"&finishing8="+E+"&lbrf1="+u+"&tgf1="+b+"&lbrf2=1&tgf2=1&lbrf3="+s+"&tgf3="+p+"&lbrf4="+c+"&tgf4="+g+"&lbrf5="+h+"&tgf5="+f+"&lbrf6="+k+"&tgf6="+y+"&lbrf7="+v+"&tgf7="+x+"&jmlset=1&modul=box3&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=pcs&ongpot=N&j_mesin=&idmesin="+F+"&idkertas="+_+"&app_id="+app_id,C=host+"/sandbox/get/";O.open("POST",C,!0),O.setRequestHeader("Content-type","application/x-www-form-urlencoded"),O.send(R)}}}CustomStyle(),$("#finishing1"+mod).click(function(){$(this).is(":checked")?($("#lbrpoly"+mod).removeAttr("readonly"),$("#tgpoly"+mod).removeAttr("readonly")):($("#lbrpoly"+mod).attr("readonly",!0),$("#tgpoly"+mod).attr("readonly",!0),$("#lbrpoly"+mod).val(1),$("#tgpoly"+mod).val(1))}),$("#pond"+mod).click(function(){$(this).is(":checked")?($("#lbrpond"+mod).removeAttr("readonly"),$("#tgpond"+mod).removeAttr("readonly")):($("#lbrpond"+mod).attr("readonly",!0),$("#tgpond"+mod).attr("readonly",!0),$("#lbrpond"+mod).val(0),$("#tgpond"+mod).val(0))}),$("#bahanbox3").filter(function(){$("select[data-source]").each(function(){var t=$(this);t.append('<option value="0">Pilih kertas</option>'),$.ajax({url:t.attr("data-source")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$("#bahan"+mod).change(function(){var t=$(this).val();$.ajax({url:host+"/kertas/",type:"post",data:{depart:t,app_id:app_id},dataType:"json",success:function(t){var a=t.length;$("#idkertas").empty();for(var e=0;e<a;e++){var n=t[e].id,o=t[e].name;$("#idkertas").append("<option value='"+n+"'>"+o+"</option>")}}})}),$("#idmesin").filter(function(){$("select[data-mesin]").each(function(){var t=$(this);t.append('<option value="0">Pilih mesin</option>'),$.ajax({url:t.attr("data-mesin")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$(document).ready(function(){$(".harga").hide(),$(".printpenawaran").hide(),$(".alert").hide(),$(".btnon, .btnd, .btnp").prop("disabled",!0),$("#jmlcetakbox3").keypress(validateNumber),$("#ketbox3").keyup(function(){$(".btnon").prop("disabled",""==this.value)})}),$(document).ready(function(){$("#lbrcetakbox3").val("10"),$("#tgcetakbox3").val("8"),$("#pjcetakbox3").val("20"),$("#bbbox3").val("1"),$("#lbrtutupbox3").val("1.5"),$("#bx3").click(function(){$("#detailbox3").length&&$("#detailbox3").remove(),$("#detailkertasbox3").length&&$("#detailkertasbox3").remove()})}),$("#cekukuranbox3").click(function(){var t=$("#jmlcetakbox3").val(),a=$("#idmesin").val();bahan=$("#bahan"+mod).val(),lbr=$("#lbrcetakbox3").val(),tg=$("#tgcetakbox3").val(),pj=$("#pjcetakbox3").val(),lebartutup=$("#lbrtutupbox3").val(),lebarlem=1.5,lbrcetak=2*parseFloat(lbr)+2*parseFloat(tg)+parseFloat(lebarlem),tgcetak=2*parseFloat(tg)+2*parseFloat(lbr)+parseFloat(lebartutup),""==t||0==t?salert("warning","Oops...",iMsg.J+" harus diisi"):0==lbr||""==lbr?salert("warning","Oops...",iMsg.L+" harus diisi"):0==tg||""==tg?salert("warning","Oops...",iMsg.T+" harus diisi"):0==pj||""==pj?salert("warning","Oops...",iMsg.P+" harus diisi"):0==a?salert("warning","Oops...",iMsg.M+" harus dipilih"):0==bahan?salert("warning","Oops...",iMsg.B+" harus dipilih"):$.ajax({url:host+"/cek/cekukuran/",type:"POST",data:{mesin:a,lbrcetak:lbrcetak,tgcetak:tgcetak,app_id:app_id},dataType:"json",success:function(t){"N"==t[0].toString()?salert("warning","Oops...","Ukuran Kebesaran"):(move(),hitungbox3())}})});
</script>
<?php
} //end token
else {
	echo json_encode(array(404 => "error"));
}
?>