<?php
if (!empty($_POST['link'])){
?>
<script type="text/javascript">
function move(){var t=document.getElementById("myBar"),a=1,e=setInterval(function(){a>=100?(clearInterval(e),$("#tablebox4").show(),$("#myBar").hide()):(a++,t.style.width=a+"%",$("#hidemyBar").removeClass("display-hidden"),$("#tablebox4").hide(),$("#myBar").show())},10)}function hitungbox4(t,a,e,n,i){lbrcetak=t,tgcetak=a,lbrcetak2=e,tgcetak2=n;var o=document.getElementById("jmlcetakbox4").value,l=document.getElementById("bahanbox4").value,r=document.getElementById("jmlwarnabox41").value,s=document.getElementById("jmlwarnabox42").value;if("Full Color"==r&&(r=4),null!=r&&r<1)alert("Jumlah Warna Minimal 1!!");else{var d,p,b=document.getElementById("lambox4").value,u=1,m=1,c=1,h=1,g=1,f=1,k=1,v=1,y=0,x=0,I=0,w=0,j=0,B=0,E=0,C=mod,_=document.getElementById("ketbox4").value,R=$("#idmesin").val(),M=$("#idkertas").val();if(d=lbrcetak/o,p=tgcetak,"12","13",1==document.getElementById("pond"+mod).checked&&(lbrpondoffset=document.getElementById("lbrpond"+mod).value,tgpondoffset=document.getElementById("tgpond"+mod).value,E="12",k=lbrpondoffset,v=tgpondoffset,B="13",y=lbrpondoffset/o,x=tgpondoffset),1==document.getElementById("finishing4box4").checked&&(w="19",c=lbrcetak,h=tgcetak),1==document.getElementById("finishing1box4").checked&&(lbrpolykop=document.getElementById("lbrpolybox4").value,tgpolykop=document.getElementById("tgpolybox4").value,j="10",g=lbrpolykop,f=tgpolykop,I="11",u=lbrpolykop/o,m=tgpolykop),null!=o&&o<1)alert("Jumlah Cetakan Kosong!!");else if(null!=lbrcetak&&lbrcetak<1)alert(" Lebar Cetakan Kosong!!");else if(null!=tgcetak&&tgcetak<1)alert("Tinggi Cetakan Kosong!!");else{var F=new XMLHttpRequest;F.onreadystatechange=function(){if(4==F.readyState&&200==F.status){myArr=JSON.parse(F.responseText);var t=myArr;if(1!=i)hitungkertasboxbwh(t);else if($("#tablbox4").length){$("#tablbox4 tr:gt(0)").remove();var a,e=$("#tablbox4").children(),n=0;for(r=0;r<t.length;r++){"Y"==t[r].ongpot&&(n=t[r].ongkos_potong),totalk=parseInt(t[r].totcetak)+parseInt(t[r].totbhn)+parseInt(n)+parseInt(t[r].tot_ctp)+parseInt(t[r].totlaminating)+parseInt(t[r].finishing1)+parseInt(t[r].finishing2)+parseInt(t[r].finishing3)+parseInt(t[r].finishing4)+parseInt(t[r].finishing5)+parseInt(t[r].finishing6)+parseInt(t[r].finishing7)+parseInt(t[r].finishing8),profit=t[r].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/o/1,o>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs");var l=btoa(encodeURIComponent(JSON.stringify(t[r])));a+="<tr class='text-left'><td>"+t[r].mesin+"</td><td class='text-right' >"+perrim+"<button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+o+"' /><input type='hidden' name='ket' value='"+_+"' /><input type='hidden' name='data1[]' value='"+l+"' /></td></tr>"}e.append(a)}else{$("#tablebox4").append("<div id='detailbox3' class='small'><table id='tablbox4' class='table table-striped table-responsive' ><thead ><tr style='background-color:<?= $warnabar; ?>;color:white' ><th  class='text-left' style='width:30%'>Mesin</th><th class='text-right'>Harga</th></tr></thead></table></div>");var r;e=$("#tablbox4").children(),n=0;for(r=0;r<t.length;r++){"Y"==t[r].ongpot&&(n=t[r].ongkos_potong),totalk=parseInt(t[r].totcetak)+parseInt(t[r].totbhn)+parseInt(n)+parseInt(t[r].tot_ctp)+parseInt(t[r].totlaminating)+parseInt(t[r].finishing1)+parseInt(t[r].finishing2)+parseInt(t[r].finishing3)+parseInt(t[r].finishing4)+parseInt(t[r].finishing5)+parseInt(t[r].finishing6)+parseInt(t[r].finishing7)+parseInt(t[r].finishing8),profit=t[r].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/o/1,o>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs");l=btoa(encodeURIComponent(JSON.stringify(t[r])));a+="<tr class='text-left'><td>"+t[r].mesin+"</td><td class='text-right' >"+perrim+"<button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+o+"' /><input type='hidden' name='ket' value='"+_+"' /><input type='hidden' name='data1[]' value='"+l+"' /></td></tr>"}e.append(a)}}};var S="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+o+"&bahan="+l+"&bb=1&jmlwarna="+r+"&jmlwarna2="+s+"&lam="+b+"&finishing1="+I+"&finishing2=12&finishing3=13&finishing4="+w+"&finishing5="+j+"&finishing6=0&finishing7="+B+"&finishing8="+E+"&lbrf1="+u+"&tgf1="+m+"&lbrf2=1&tgf2=1&lbrf3="+d+"&tgf3="+p+"&lbrf4="+c+"&tgf4="+h+"&lbrf5="+g+"&tgf5="+f+"&lbrf6="+k+"&tgf6="+v+"&lbrf7="+y+"&tgf7="+x+"&jmlset=1&modul="+C+"&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=lbr&ongpot=N&j_mesin=&idmesin="+R+"&idkertas="+M+"&app_id="+app_id,K=host+"/sandbox/get/";F.open("POST",K,!0),F.setRequestHeader("Content-type","application/x-www-form-urlencoded"),F.send(S)}}}function hitungkertasboxbwh(t){var a=t,e=document.getElementById("lbrcetakbox4").value,n=document.getElementById("tgcetakbox4").value,i=document.getElementById("pjcetakbox4").value,o=document.getElementById("lbrtutupbox4").value,l=document.getElementById("lbrdimensi4").value;if(lbrcetak=4*parseFloat(n)+2*parseFloat(o)+parseFloat(e)+2*parseFloat(l),tgcetak=4*parseFloat(n)+2*parseFloat(o)+parseFloat(i)+2*parseFloat(l),$("#tutupboxbawah1").attr("checked"))var r=document.getElementById("bahanbox4").value;else r=document.getElementById("bahanbawahbox4").value;var s=document.getElementById("jmlcetakbox4").value,d=document.getElementById("jmlwarnabawahbox41").value,p=document.getElementById("jmlwarnabawahbox42").value;if(null!=d&&d<1)alert("Jumlah Warna Minimal 1!!");else{1==document.getElementById("tutupboxbawah1").checked&&(d=0);var b,u,m=document.getElementById("lambawahbox4").value,c=1,h=1,g=1,f=1,k=1,v=1,y=0,x=0,I=0,w=document.getElementById("ketbox4").value,j=$("#idmesin").val();if(1==document.getElementById("tutupboxbawah1").checked){j=$("#idmesin").val();var B=$("#idkertas").val()}else j=$("#idmesinb").val(),B=$("#idkertasb").val();if(b=lbrcetak/s,u=tgcetak,"12","13",1==document.getElementById("finishing4bawahbox4").checked&&(x="19",g=lbrcetak,f=tgcetak),1==document.getElementById("finishing1bawahbox4").checked&&(lbrpolykop=document.getElementById("lbrpolybawahbox4").value,tgpolykop=document.getElementById("tgpolybawahbox4").value,I="10",k=lbrpolykop,v=tgpolykop,y="11",c=lbrpolykop/s,h=tgpolykop),null!=s&&s<1)alert("Jumlah Cetakan Kosong!!");else if(null!=lbrcetak&&lbrcetak<1)alert(" Lebar Cetakan Kosong!!");else if(null!=tgcetak&&tgcetak<1)alert("Tinggi Cetakan Kosong!!");else{var E=new XMLHttpRequest;E.onreadystatechange=function(){if(4==E.readyState&&200==E.status){myArr=JSON.parse(E.responseText);var t=0,e=myArr;subtotal2=parseInt(e[0].totcetak)+parseInt(e[0].totbhn)+parseInt(t)+parseInt(e[0].tot_ctp)+parseInt(e[0].totlaminating)+parseInt(e[0].finishing1)+parseInt(e[0].finishing2)+parseInt(e[0].finishing3)+parseInt(e[0].finishing4)+parseInt(e[0].finishing5)+parseInt(e[0].finishing6);var n=btoa(encodeURIComponent(JSON.stringify(e[0])));if($("#tablbox4").length){$("#tablbox4 tr:gt(0)").remove();var i,o=$("#tablbox4").children();t=0;for(r=0;r<a.length;r++){"Y"==a[r].ongpot&&(t=a[r].ongkos_potong),subtotal1=parseInt(a[r].totcetak)+parseInt(a[r].totbhn)+parseInt(t)+parseInt(a[r].tot_ctp)+parseInt(a[r].totlaminating)+parseInt(a[r].finishing1)+parseInt(a[r].finishing2)+parseInt(a[r].finishing3)+parseInt(a[r].finishing4)+parseInt(a[r].finishing5)+parseInt(a[r].finishing6);var l=btoa(encodeURIComponent(JSON.stringify(a[r])));total=subtotal1+subtotal2,profit=a[r].persen,jual=parseInt(total)*profit/100+parseInt(total),satuan=jual/s/1,s>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs"),i+="<tr class='text-md-left'><td>"+a[r].mesin+"</td><td class='text-md-right' >"+perrim+"<button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+s+"' /><input type='hidden' name='ket' value='"+w+"' /><input type='hidden' name='data1[]' value='"+l+"' /><input type='hidden' name='data2[]' value='"+n+"' /></td></tr>"}o.append(i)}else{$("#tablebox4").append("<div id='detailbox3' class='small'><table id='tablbox4' class='table table-striped' ><thead ><tr style='background-color:<?= $warnabar; ?>;color:white' ><th  class='text-md-left' style='width:30%'>Mesin</th><th class='text-md-right'>Harga</th></tr></thead></table></div>");var r;o=$("#tablbox4").children(),t=0;for(r=0;r<a.length;r++){"Y"==a[r].ongpot&&(t=a[r].ongkos_potong),subtotal1=parseInt(a[r].totcetak)+parseInt(a[r].totbhn)+parseInt(t)+parseInt(a[r].tot_ctp)+parseInt(a[r].totlaminating)+parseInt(a[r].finishing1)+parseInt(a[r].finishing2)+parseInt(a[r].finishing3)+parseInt(a[r].finishing4)+parseInt(a[r].finishing5)+parseInt(a[r].finishing6);l=btoa(encodeURIComponent(JSON.stringify(a[r])));total=subtotal1+subtotal2,profit=a[r].persen,jual=parseInt(total)*profit/100+parseInt(total),satuan=jual/s/1,s>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs"),i+="<tr class='text-md-left'><td>"+a[r].mesin+"</td><td class='text-md-right' >"+perrim+"<button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+s+"' /><input type='hidden' name='ket' value='"+w+"' /><input type='hidden' name='data1[]' value='"+l+"' /><input type='hidden' name='data2[]' value='"+n+"' /></td></tr>"}o.append(i)}}};var C="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+s+"&bahan="+r+"&bb=1&jmlwarna="+d+"&jmlwarna2="+p+"&lam="+m+"&finishing1="+y+"&finishing2=12&finishing3=13&finishing4="+x+"&finishing5="+I+"&finishing6=0&finishing7=0&finishing8=0&lbrf1="+c+"&tgf1="+h+"&lbrf2=1&tgf2=1&lbrf3="+b+"&tgf3="+u+"&lbrf4="+g+"&tgf4="+f+"&lbrf5="+k+"&tgf5="+v+"&lbrf6=1&tgf6=1&lbrf7=0&tgf7=0&jmlset=1&modul=box4&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=pcs&ongpot=N&j_mesin=&idmesin="+j+"&idkertas="+B+"&app_id="+app_id,_=host+"/sandbox/get/";E.open("POST",_,!0),E.setRequestHeader("Content-type","application/x-www-form-urlencoded"),E.send(C)}}}$("#finishing1"+mod).click(function(){$(this).is(":checked")?($("#lbrpoly"+mod).removeAttr("readonly"),$("#tgpoly"+mod).removeAttr("readonly")):($("#lbrpoly"+mod).attr("readonly",!0),$("#tgpoly"+mod).attr("readonly",!0),$("#lbrpoly"+mod).val(1),$("#tgpoly"+mod).val(1))}),$("#pond"+mod).click(function(){$(this).is(":checked")?($("#lbrpond"+mod).removeAttr("readonly"),$("#tgpond"+mod).removeAttr("readonly")):($("#lbrpond"+mod).attr("readonly",!0),$("#tgpond"+mod).attr("readonly",!0),$("#lbrpond"+mod).val(0),$("#tgpond"+mod).val(0))}),$("#bahanbawah"+mod).filter(function(){$("select[data-bawah]").each(function(){var t=$(this);t.append('<option value="0">Pilih kertas bawah</option>'),$.ajax({url:t.attr("data-bawah")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKeys")]).text(a[t.attr("data-displayKeys")]),t.append(e)})})})}),$("#bahanbawah"+mod).change(function(){var t=$(this).val();$.ajax({url:host+"/kertas/",type:"post",data:{depart:t,app_id:app_id},dataType:"json",success:function(t){var a=t.length;$("#idkertasb").empty();for(var e=0;e<a;e++){var n=t[e].id,i=t[e].name;$("#idkertasb").append("<option value='"+n+"'>"+i+"</option>")}}})}),$("#idmesinb").filter(function(){$("select[data-mesinb]").each(function(){var t=$(this);t.append('<option value="0">Pilih mesin bawah</option>'),$.ajax({url:t.attr("data-mesinb")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKeys")]).text(a[t.attr("data-displayKeys")]),t.append(e)})})})}),$("#bahanbox4").filter(function(){$("select[data-source]").each(function(){var t=$(this);t.append('<option value="0">Pilih kertas</option>'),$.ajax({url:t.attr("data-source")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$("#bahan"+mod).change(function(){var t=$(this).val();$.ajaxAntri({url:host+"/kertas/",type:"post",data:{depart:t,app_id:app_id},dataType:"json",success:function(t){var a=t.length;$("#idkertas").empty();for(var e=0;e<a;e++){var n=t[e].id,i=t[e].name;$("#idkertas").append("<option value='"+n+"'>"+i+"</option>")}}})}),$("#bahan"+mod).change(function(){""==$(this).val()||"0"==$(this).val()?($(".bahan"+mod).removeClass("has-success").addClass("has-danger"),$(".idkertas").removeClass("has-success").addClass("has-danger")):($(".bahan"+mod).removeClass("has-danger").addClass("has-success"),$(".idkertas").removeClass("has-danger").addClass("has-success"),$("#not4").removeClass("blink-bg"))}),$("#idmesin").filter(function(){$("select[data-mesin]").each(function(){var t=$(this);t.append('<option value="0">Pilih mesin</option>'),$.ajax({url:t.attr("data-mesin")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$(document).ready(function(){$(".harga").hide(),$(".printpenawaran").hide(),$(".alert").hide(),$("#c-nav").hide(),$(".btnon, .btnd, .btnp").prop("disabled",!0),$("#jmlcetakbox4").keypress(validateNumber),$("#ketbox4").keyup(function(){$(".btn").prop("disabled",""==this.value)})}),$(document).ready(function(){$("#lbrcetakbox4").val("10"),$("#tgcetakbox4").val("5"),$("#pjcetakbox4").val("20"),$("#lbrtutupbox4").val("1.5"),$("#lbrdimensi4").val("0.5"),$(".gabungcetakbox4").hide(),$(".tutupbawah").hide(),$(".progress").hide(),$("#bx4").click(function(){$("#detailbox4").length&&$("#detailbox4").remove(),$("#detailkertasbox4").length&&$("#detailkertasbox4").remove()})}),$("#tutupboxbawah1").click(function(){$("#tutupboxbawah1").attr("checked")?($("#tutupboxbawah1").attr("checked",!1),$("#gabungcetakbox4").prop("checked",!0),$(".gabungcetakbox4").show()):($("#tutupboxbawah1").attr("checked","checked"),$(".gabungcetakbox4").hide(),$(".tutupbawah").hide())}),$("#gabungcetakbox4").click(function(){$("#gabungcetakbox4").attr("checked")?($("#gabungcetakbox4").attr("checked",!1),$(".tutupbawah").show()):($("#gabungcetakbox4").attr("checked","checked"),$(".tutupbawah").hide())}),CustomStyle(),$("#cekukuran"+mod).click(function(){CustomStyle();var t=$("#jmlcetak"+mod).val(),a=$("#lbrcetak"+mod).val(),e=$("#pjcetak"+mod).val(),n=$("#idmesin").val(),i=$("#idmesinb").val(),o=$("#bahan"+mod).val(),l=$("#bahanbawah"+mod).val(),r=$("#jmlwarnabox41").val();if(""==t||"0"==t)$(".jml").addClass("has-danger"),alertx("Jumlah belum diisi","not1","jmlcetakp");else if(""==a||0==a)alertx("Lebar cetak belum diisi","a","lbrcetakp");else if(""==e||0==e)alertx("Tinggi cetak belum diisi","a","tgcetakp");else if(""==r||0==r)alertx("Jumlah warna belum diisi","a","jmlwarnap");else if(0==n)alertx("mesin belum dipilih","not3","idmesin");else if(0==o)alertx("bahan belum dipilih","not4","bahanp");else{var s=document.getElementById("jmlwarnabox41").value,d=document.getElementById("bahanbox4").value;if(null!=t&&t<1)return void salert("warning","Oops...","Jumlah Cetakan Kosong!!");if(null!=s&&s<1)return void salert("warning","Oops...","Jumlah Warna Minimal 1!!");if(0==d)return void salert("warning","Oops...","bahan belum dipilih");if(0==n)return void salert("warning","Oops...","mesin belum dipilih");$(".simpan").html("Simpan");var p=document.getElementById("lbrcetakbox4").value,b=document.getElementById("tgcetakbox4").value,u=document.getElementById("pjcetakbox4").value,m=document.getElementById("lbrtutupbox4").value,c=document.getElementById("lbrdimensi4").value;if(p>u)p=document.getElementById("pjcetakbox4").value,u=document.getElementById("lbrcetakbox4").value;if(lbrcetak=4*parseFloat(b)+2*parseFloat(m)+parseFloat(p)+.2,tgcetak=4*parseFloat(b)+2*parseFloat(m)+parseFloat(u)+.2,lbrcetak2=4*parseFloat(b)+2*parseFloat(m)+parseFloat(p)+2*parseFloat(c),tgcetak2=4*parseFloat(b)+2*parseFloat(m)+parseFloat(u)+2*parseFloat(c),1==document.getElementById("tutupboxbawah1").checked)bawah=0;else if(1==document.getElementById("gabungcetakbox4").checked)bawah=1,tgcetak>tgcetak2?tinggicetakan=tgcetak:tinggicetakan=tgcetak2,lebarcetakan=lbrcetak+lbrcetak2,lbrcetak=lebarcetakan,tgcetak=tinggicetakan,$("#idmesinb").val(0),$("#bahanbawah"+mod).val(0);else{if(""==i||0==i)return salert("warning","Oops...","Mesin bawah belum dipilih"),!1;if(""==l||"0"==l)return salert("warning","Oops...","Bahan bawah belum dipilih"),!1;bawah=0}move(),$.ajax({url:host+"/cek/cekukuran/",type:"POST",data:{mesin:n,lbrcetak:lbrcetak,tgcetak:tgcetak,app_id:app_id},dataType:"json",beforeSend:function(){$("#not1").removeClass("blink-bg")},success:function(t){"N"==t[0].toString()?alertx("Ukuran Kebesaran"):(move(),hitungbox4(lbrcetak,tgcetak,lbrcetak2,tgcetak2,bawah))}})}});
</script>
<?php
} //end token
else {
	echo json_encode(array(404 => "error"));
}
?>