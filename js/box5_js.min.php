<?php
if (!empty($_POST['link'])){
?>
<script type="text/javascript">
	function move(){var t=document.getElementById("myBar"),a=1,e=setInterval(function(){a>=100?(clearInterval(e),$("#tablebox5").show(),$("#myBar").hide()):(a++,t.style.width=a+"%",$("#hidemyBar").removeClass("display-hidden"),$("#tablebox5").hide(),$("#myBar").show())},10)}function hitungbox5(){var t=document.getElementById("lbrcetakbox5").value,a=document.getElementById("tgcetakbox5").value,e=document.getElementById("pjcetakbox5").value,n=document.getElementById("llabox5").value,o=document.getElementById("llsbox5").value;lbrcetak=2*parseFloat(o)+2*parseFloat(a)+parseFloat(e),tgcetak=2*parseFloat(a)+2*parseFloat(t)+parseFloat(n);var l=document.getElementById("jmlcetakbox5").value,d=document.getElementById("bahanbox5").value,r=document.getElementById("bbbox5").value,s=document.getElementById("jmlwarnabox51").value,i=document.getElementById("jmlwarnabox52").value;if("Full Color"==s&&(s=4),null!=s&&s<1)alert("Jumlah Warna Minimal 1!!");else{var p,m,c=document.getElementById("lambox5").value,u=1,b=1,g=1,h=1,f=1,v=1,y=1,k=1,x=0,I=0,B=0,j=0,w=0,E=0,C=0,M=document.getElementById("ketbox5").value,_=$("#idmesin").val(),F=$("#idkertas").val();if(p=lbrcetak/l,m=tgcetak,"12","13",1==document.getElementById("pond"+mod).checked&&(lbrpondoffset=document.getElementById("lbrpond"+mod).value,tgpondoffset=document.getElementById("tgpond"+mod).value,C="12",y=lbrpondoffset,k=tgpondoffset,E="13",x=lbrpondoffset/l,I=tgpondoffset),1==document.getElementById("finishing4box5").checked&&(j="19",g=lbrcetak,h=tgcetak),1==document.getElementById("finishing1box5").checked&&(lbrpolykop=document.getElementById("lbrpolybox5").value,tgpolykop=document.getElementById("tgpolybox5").value,w="10",f=lbrpolykop,v=tgpolykop,B="11",u=lbrpolykop/l,b=tgpolykop),null!=l&&l<1)alert("Jumlah Cetakan Kosong!!");else if(null!=lbrcetak&&lbrcetak<1)alert(" Lebar Cetakan Kosong!!");else if(null!=tgcetak&&tgcetak<1)alert("Tinggi Cetakan Kosong!!");else{var R=new XMLHttpRequest;R.onreadystatechange=function(){if(4==R.readyState&&200==R.status)if(myArr=JSON.parse(R.responseText),data=myArr,$("#tablbox5").length){$("#tablbox5 tr:gt(0)").remove();var t=$("#tablbox5").children(),a=0;for(n=0;n<data.length;n++){"Y"==data[n].ongpot&&(a=data[n].ongkos_potong),totalk=parseInt(data[n].totcetak)+parseInt(data[n].totbhn)+parseInt(a)+parseInt(data[n].tot_ctp)+parseInt(data[n].totlaminating)+parseInt(data[n].finishing1)+parseInt(data[n].finishing2)+parseInt(data[n].finishing3)+parseInt(data[n].finishing4)+parseInt(data[n].finishing5)+parseInt(data[n].finishing6)+parseInt(data[n].finishing7)+parseInt(data[n].finishing8),profit=data[n].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/l/1,l>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs");var e=btoa(encodeURIComponent(JSON.stringify(data[n])));o+="<tr class='text-left'><td>"+data[n].mesin+"</td><td class='text-right' >"+perrim+"<button type='submit' name='submit' value='"+[n]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+l+"' /><input type='hidden' name='ket' value='"+M+"' /><input type='hidden' name='data1[]' value='"+e+"' /></td></tr>"}t.append(o)}else{$("#tablebox5").append("<div id='detailbox5' class='small'><table id='tablbox5' class='table table-striped pb-0' ><thead ><tr style='background-color:<?= $warnabar; ?>;color:white' ><th  class='text-md-left' style='width:30%'>Mesin</th><th class='text-md-right'>Harga</th></tr></thead></table></div>");var n,o;t=$("#tablbox5").children(),a=0;for(n=0;n<data.length;n++){"Y"==data[n].ongpot&&(a=data[n].ongkos_potong),totalk=parseInt(data[n].totcetak)+parseInt(data[n].totbhn)+parseInt(a)+parseInt(data[n].tot_ctp)+parseInt(data[n].totlaminating)+parseInt(data[n].finishing1)+parseInt(data[n].finishing2)+parseInt(data[n].finishing3)+parseInt(data[n].finishing4)+parseInt(data[n].finishing5)+parseInt(data[n].finishing6),profit=data[n].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/l/1,perrim=500*satuan;e=btoa(encodeURIComponent(JSON.stringify(data[n])));o+="<tr class='text-md-left'><td>"+data[n].mesin+"</td><td class='text-md-right' >Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim <button type='submit' name='submit' value='"+[n]+"' class='btn btn-warning btn-sm' style='background-color:<?= $warnabar; ?>;color:white;width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='ket' value='"+M+"' /></td><input type='hidden' name='jumlahcetak' value='"+l+"' /><input type='hidden' name='data1[]' value='"+e+"' /></tr>"}t.append(o)}};var O="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+l+"&bahan="+d+"&bb="+r+"&jmlwarna="+s+"&jmlwarna2="+i+"&lam="+c+"&finishing1="+B+"&finishing2=12&finishing3=13&finishing4="+j+"&finishing5="+w+"&finishing6=0&finishing7="+E+"&finishing8="+C+"&lbrf1="+u+"&tgf1="+b+"&lbrf2=1&tgf2=1&lbrf3="+p+"&tgf3="+m+"&lbrf4="+g+"&tgf4="+h+"&lbrf5="+f+"&tgf5="+v+"&lbrf6="+y+"&tgf6="+k+"&lbrf7="+x+"&tgf7="+I+"&jmlset=1&modul=box5&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=pcs&ongpot=N&j_mesin=&idmesin="+_+"&idkertas="+F+"&app_id="+app_id,S=host+"/sandbox/get/";R.open("POST",S,!0),R.setRequestHeader("Content-type","application/x-www-form-urlencoded"),R.send(O)}}}$("#finishing1"+mod).click(function(){$(this).is(":checked")?($("#lbrpoly"+mod).removeAttr("readonly"),$("#tgpoly"+mod).removeAttr("readonly")):($("#lbrpoly"+mod).attr("readonly",!0),$("#tgpoly"+mod).attr("readonly",!0),$("#lbrpoly"+mod).val(1),$("#tgpoly"+mod).val(1))}),$("#pond"+mod).click(function(){$(this).is(":checked")?($("#lbrpond"+mod).removeAttr("readonly"),$("#tgpond"+mod).removeAttr("readonly")):($("#lbrpond"+mod).attr("readonly",!0),$("#tgpond"+mod).attr("readonly",!0),$("#lbrpond"+mod).val(0),$("#tgpond"+mod).val(0))}),$(".harga").hide(),$(".printpenawaran").hide(),$(".alert").hide(),$(".btnon, .btnd, .btnp").prop("disabled",!0),$("#jmlcetakbox5").keypress(validateNumber),$("#ketbox5").keyup(function(){$(".btnon").prop("disabled",""==this.value)}),$(".modal").on("hidden.bs.modal",function(){$(this).removeData("bs.modal")}),$("#bahan"+mod).filter(function(){$("select[data-source]").each(function(){var t=$(this);t.append('<option value="0">Pilih kertas</option>'),$.ajax({url:t.attr("data-source")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$("#bahan"+mod).change(function(){var t=$(this).val();$.ajaxAntri({url:host+"/kertas/",type:"post",data:{depart:t,app_id:app_id},dataType:"json",success:function(t){var a=t.length;$("#idkertas").empty();for(var e=0;e<a;e++){var n=t[e].id,o=t[e].name;$("#idkertas").append("<option value='"+n+"'>"+o+"</option>")}}})}),$("#bahan"+mod).change(function(){""==$(this).val()||"0"==$(this).val()?($(".bahan"+mod).removeClass("has-success").addClass("has-danger"),$(".idkertas").removeClass("has-success").addClass("has-danger")):($(".bahan"+mod).removeClass("has-danger").addClass("has-success"),$(".idkertas").removeClass("has-danger").addClass("has-success"),$("#not4").removeClass("blink-bg"))}),$("#idmesin").filter(function(){$("select[data-mesin]").each(function(){var t=$(this);t.append('<option value="0">Pilih mesin</option>'),$.ajax({url:t.attr("data-mesin")}).then(function(a){a.map(function(a){var e=$("<option>");e.val(a[t.attr("data-valueKey")]).text(a[t.attr("data-displayKey")]),t.append(e)})})})}),$(document).ready(function(){$("#lbrcetakbox5").val("10"),$("#tgcetakbox5").val("8"),$("#pjcetakbox5").val("20"),$("#bbbox5").val("1"),$("#llabox5").val("5"),$("#llsbox5").val("2"),$("#bx5").click(function(){$("#detailbox5").length&&$("#detailbox5").remove(),$("#detailkertasbox5").length&&$("#detailkertasbox5").remove()})}),$("#jmlcetakbox5").blur(function(){$("#jmlcetakbox5").removeClass("border-red")}),$("#bahanbox5").change(function(){$("#bahanbox5").removeClass("border-red")}),$("#idmesin").change(function(){$("#idmesin").removeClass("border-red")}),CustomStyle(),$("#cekukuran"+mod).click(function(){var t=document.getElementById("jmlcetakbox5").value,a=document.getElementById("jmlwarnabox51").value,e=document.getElementById("bahanbox5").value,n=document.getElementById("idmesin").value;if(null!=t&&t<1)salert("warning","Oops...",iMsg.J);else if(null!=a&&a<1)salert("warning","Oops...",iMsg.W);else{if(0==n)return salert("warning","Oops...",iMsg.M),void $("#idmesin").addClass("border-red");if(0==e)return salert("warning","Oops...",iMsg.B),void $("#bahanbox5").addClass("border-red");var o=document.getElementById("lbrcetakbox5").value,l=document.getElementById("tgcetakbox5").value,d=document.getElementById("pjcetakbox5").value,r=document.getElementById("llabox5").value,s=document.getElementById("llsbox5").value;lbrcetak=2*parseFloat(s)+2*parseFloat(l)+parseFloat(d),tgcetak=2*parseFloat(l)+2*parseFloat(o)+parseFloat(r),$.ajax({url:host+"/cek/cekukuran/",type:"POST",data:{mesin:n,lbrcetak:lbrcetak,tgcetak:tgcetak,app_id:app_id},dataType:"json",beforeSend:function(){CustomStyle(),move()},success:function(t){"N"==t[0].toString()?salert("warning","Oops...",iMsg.U):(move(),hitungbox5())}})}});
</script>
<?php
} //end token
else {
	echo json_encode(array(404 => "error"));
}
?>