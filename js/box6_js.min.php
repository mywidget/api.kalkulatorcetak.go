<?php
if (!empty($_POST['link'])){
?>
<script type="text/javascript">
 function move(){var a=document.getElementById("myBar"),t=1,e=setInterval(function(){t>=100?(clearInterval(e),$(app_mod).show(),$("#myBar").hide()):(t++,a.style.width=t+"%",$(app_mod).hide(),$("#myBar").show())},10)}function hitungbox6(a,t,e,n,s){lbrcetak=a,tgcetak=t,lbrcetak2=e,tgcetak2=n;var i=document.getElementById("jmlcetakbox6").value,o=document.getElementById("bahanbox6").value,l=document.getElementById("bbbox6").value,d=document.getElementById("jmlwarnabox61").value,r=document.getElementById("jmlwarnabox62").value;if("Full Color"==d&&(d=4),null!=d&&d<1)alert("Jumlah Warna Minimal 1!!");else{var p,c,u=document.getElementById("lambox6").value,m=1,h=1,b=1,g=1,k=1,f=1,v=0,y=0,x=0,I=document.getElementById("ketbox6").value,w=$("#idmesin").val(),j=$("#idkertas").val();if(p=lbrcetak/i,c=tgcetak,"12","13",1==document.getElementById("finishing4box6").checked&&(y="19",b=lbrcetak,g=tgcetak),1==document.getElementById("finishing1box6").checked&&(lbrpolykop=document.getElementById("lbrpolybox6").value,tgpolykop=document.getElementById("tgpolybox6").value,x="10",k=lbrpolykop,f=tgpolykop,v="11",m=lbrpolykop/i,h=tgpolykop),null!=i&&i<1)alert("Jumlah Cetakan Kosong!!");else if(null!=lbrcetak&&lbrcetak<1)alert(" Lebar Cetakan Kosong!!");else if(null!=tgcetak&&tgcetak<1)alert("Tinggi Cetakan Kosong!!");else{var C=new XMLHttpRequest;C.onreadystatechange=function(){if(4==C.readyState&&200==C.status)if(data=JSON.parse(C.responseText),"Y"==data[0].akses)if(1!=s)hitungkertasbox6bwh(data);else if($(ch_mod).length){$(ch_mod+" tr:gt(0)").remove();var a,t=$(ch_mod).children(),e=0;for(o=0;o<data.length;o++){"Y"==data[o].ongpot&&(e=data[o].ongkos_potong),totalk=parseInt(data[o].totcetak)+parseInt(data[o].totbhn)+parseInt(e)+parseInt(data[o].tot_ctp)+parseInt(data[o].totlaminating)+parseInt(data[o].finishing1)+parseInt(data[o].finishing2)+parseInt(data[o].finishing3)+parseInt(data[o].finishing4)+parseInt(data[o].finishing5)+parseInt(data[o].finishing6),profit=data[o].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/i/1,perrim=500*satuan;var n=btoa(encodeURIComponent(JSON.stringify(data[o])));a+="<tr id='ctr' class='text-md-left'><td>"+data[o].mesin+"</td><td id='ctd' class='text-md-right' >Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim <button type='submit' name='submit' value='"+[o]+"' class='btn btn-warning btn-sm' style='width:120px'>Rp."+formatMoney(jual)+"</button></td><input type='hidden' name='jumlahcetak' value='"+i+"' /><input type='hidden' name='ket' value='"+I+"' /><input type='hidden' name='data1[]' value='"+n+"' /></tr>"}t.append(a)}else{$(app_mod).append("<div class='small table-responsive'><table id='"+id_mod+"' class='table table-striped' ><thead ><tr id='ctrh'><th id='cthh' class='text-md-left' style='width:30%'>Mesin</th><th class='text-md-right'>Harga</th></tr></thead></table></div>");var o;t=$(ch_mod).children(),e=0;for(o=0;o<data.length;o++){"Y"==data[o].ongpot&&(e=data[o].ongkos_potong),totalk=parseInt(data[o].totcetak)+parseInt(data[o].totbhn)+parseInt(e)+parseInt(data[o].tot_ctp)+parseInt(data[o].totlaminating)+parseInt(data[o].finishing1)+parseInt(data[o].finishing2)+parseInt(data[o].finishing3)+parseInt(data[o].finishing4)+parseInt(data[o].finishing5)+parseInt(data[o].finishing6),profit=data[o].persen,jual=parseInt(totalk)*profit/100+parseInt(totalk),satuan=jual/i/1,perrim=500*satuan;n=btoa(encodeURIComponent(JSON.stringify(data[o])));a+="<tr id='ctr' class='text-md-left'><td>"+data[o].mesin+"</td><td id='ctd' class='text-md-right' >Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim <button type='submit' name='submit' value='"+[o]+"' class='btn btn-warning btn-sm' style='width:120px'>Rp."+formatMoney(jual)+"</button></td><input type='hidden' name='jumlahcetak' value='"+i+"' /><input type='hidden' name='ket' value='"+I+"' /><input type='hidden' name='data1[]' value='"+n+"' /></tr>"}t.append(a)}else $(app_mod).hide(),$(ch_mod).show(),$(app_mod).append("<div class='small'>Data tidak ditemukan</div>")};var _="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+i+"&bahan="+o+"&bb="+l+"&jmlwarna="+d+"&jmlwarna2="+r+"&lam="+u+"&finishing1="+v+"&finishing2=12&finishing3=13&finishing4="+y+"&finishing5="+x+"&finishing6=0&lbrf1="+m+"&tgf1="+h+"&lbrf2=1&tgf2=1&lbrf3="+p+"&tgf3="+c+"&lbrf4="+b+"&tgf4="+g+"&lbrf5="+k+"&tgf5="+f+"&lbrf6=1&tgf6=1&jmlset=1&modul=box6&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=lbr&ongpot=N&kethitung=Box_Atas&idmesin="+w+"&app_id="+app_id+"&j_mesin=&idkertas="+j;C.open("POST","/sandbox/get/",!0),C.setRequestHeader("Content-type","application/x-www-form-urlencoded"),C.setRequestHeader("Cache-Control","no-cache"),C.setRequestHeader("Pragma","no-cache"),C.send(_)}}}function hitungkertasbox6bwh(a){var t=a,e=document.getElementById("lbrcetakbox6").value,n=document.getElementById("tgtutupbawahbox6").value,s=document.getElementById("pjcetakbox6").value;lbrcetak=2*parseFloat(n)+parseFloat(e),tgcetak=2*parseFloat(n)+parseFloat(s);var i=document.getElementById("jmlcetakbox6").value,o=document.getElementById("bahanbawahbox6").value,l=document.getElementById("bbbox6").value,d=document.getElementById("jmlwarnabawahbox61").value,r=document.getElementById("jmlwarnabawahbox62").value;1==document.getElementById("tutupboxbawahbox6").checked&&(d=0,r=0);var p,c,u=document.getElementById("lambawahbox6").value,m=1,h=1,b=1,g=1,k=1,f=1,v=0,y=0,x=0,I=document.getElementById("ketbox6").value;if(1==document.getElementById("tutupboxbawahbox6").checked)var w=$("#idmesin").val(),j=$("#idkertas").val();else w=$("#idmesinb").val(),j=$("#idkertasb").val();p=lbrcetak/i,c=tgcetak,1==document.getElementById("finishing4bawahbox6").checked&&(y="19",b=lbrcetak,g=tgcetak),1==document.getElementById("finishing1bawahbox6").checked&&(lbrpolykop=document.getElementById("lbrpolybawahbox6").value,tgpolykop=document.getElementById("tgpolybawahbox6").value,x="10",k=lbrpolykop,f=tgpolykop,v="11",m=lbrpolykop/i,h=tgpolykop);var C=new XMLHttpRequest;C.onreadystatechange=function(){if(4==C.readyState&&200==C.status){var a=C.responseText,e=JSON.parse(a);if("Y"==e[0].akses){var n=0;subtotal2=parseInt(e[0].totcetak)+parseInt(e[0].totbhn)+parseInt(n)+parseInt(e[0].tot_ctp)+parseInt(e[0].totlaminating)+parseInt(e[0].finishing1)+parseInt(e[0].finishing2)+parseInt(e[0].finishing3)+parseInt(e[0].finishing4)+parseInt(e[0].finishing5)+parseInt(e[0].finishing6);var s=btoa(encodeURIComponent(JSON.stringify(e[0])));if($(ch_mod).length){$(ch_mod+" tr:gt(0)").remove();var o,l=$(ch_mod).children();n=0;for(r=0;r<t.length;r++){"Y"==t[r].ongpot&&(n=t[r].ongkos_potong),subtotal1=parseInt(t[r].totcetak)+parseInt(t[r].totbhn)+parseInt(n)+parseInt(t[r].tot_ctp)+parseInt(t[r].totlaminating)+parseInt(t[r].finishing1)+parseInt(t[r].finishing2)+parseInt(t[r].finishing3)+parseInt(t[r].finishing4)+parseInt(t[r].finishing5)+parseInt(t[r].finishing6);var d=btoa(encodeURIComponent(JSON.stringify(t[r])));total=subtotal1+subtotal2,profit=t[r].persen,jual=parseInt(total)*profit/100+parseInt(total),satuan=jual/i/1,i>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs"),o+="<tr id='ctr' class='text-md-left'><td>"+t[r].mesin+"</td><td id='ctd' class='text-md-right' >"+perrim+" <button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+i+"' /><input type='hidden' name='ket' value='"+I+"' /><input type='hidden' name='data1[]' value='"+d+"' /><input type='hidden' name='data2[]' value='"+s+"' /></td></tr>"}l.append(o)}else{$(app_mod).append("<div class='small table-responsive'><table id='"+id_mod+"' class='table table-striped' ><thead><tr id='ctrh' ><th  id='cthh' class='text-md-left' style='width:30%'>Mesin</th><th class='text-md-right'>Harga</th></tr></thead></table></div>");var r;l=$(ch_mod).children(),n=0;for(r=0;r<t.length;r++){"Y"==t[r].ongpot&&(n=t[r].ongkos_potong),subtotal1=parseInt(t[r].totcetak)+parseInt(t[r].totbhn)+parseInt(n)+parseInt(t[r].tot_ctp)+parseInt(t[r].totlaminating)+parseInt(t[r].finishing1)+parseInt(t[r].finishing2)+parseInt(t[r].finishing3)+parseInt(t[r].finishing4)+parseInt(t[r].finishing5)+parseInt(t[r].finishing6);d=btoa(encodeURIComponent(JSON.stringify(t[r])));total=subtotal1+subtotal2,profit=t[r].persen,jual=parseInt(total)*profit/100+parseInt(total),satuan=jual/i/1,i>=500?(perrim=500*satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs - Rp. "+formatMoney(perrim)+"/rim"):(perrim=satuan,perrim="Rp. "+formatMoney(satuan)+"/pcs"),o+="<tr id='ctr' class='text-md-left'><td>"+t[r].mesin+"</td><td id='ctd' class='text-md-right' >"+perrim+" <button type='submit' name='submit' value='"+[r]+"' class='btn btn-warning btn-sm' style='width:120px'>Rp."+formatMoney(jual)+"</button><input type='hidden' name='jumlahcetak' value='"+i+"' /><input type='hidden' name='ket' value='"+I+"' /><input type='hidden' name='data1[]' value='"+d+"' /><input type='hidden' name='data2[]' value='"+s+"' /></td></tr>"}l.append(o)}}else $(app_mod).hide(),$(ch_mod).show(),$(app_mod).append("<div class='small'>Data tidak ditemukan</div>")}};var _="lbrcetak="+lbrcetak+"&tgcetak="+tgcetak+"&jmlcetak="+i+"&bahan="+o+"&bb="+l+"&jmlwarna="+d+"&jmlwarna2="+r+"&lam="+u+"&finishing1="+v+"&finishing2=12&finishing3=13&finishing4="+y+"&finishing5="+x+"&finishing6=0&lbrf1="+m+"&tgf1="+h+"&lbrf2=1&tgf2=1&lbrf3="+p+"&tgf3="+c+"&lbrf4="+b+"&tgf4="+g+"&lbrf5="+k+"&tgf5="+f+"&lbrf6=1&tgf6=1&jmlset=1&modul=box6&insheet=1&jml_satuan=1&cetak_bagi=Y&ket_satuan=pcs&ongpot=N&kethitung=Box_Bawah&idmesin="+w+"&app_id="+app_id+"&j_mesin=&idkertas="+j;C.open("POST","/sandbox/get/",!0),C.setRequestHeader("Content-type","application/x-www-form-urlencoded"),C.send(_)}$(document).ready(function(){CustomStyle(),$(".harga").hide(),$(".printpenawaran").hide(),$(".alert").hide(),$("#c-nav").hide(),$(".btnon, .btnd, .btnp").prop("disabled",!0),$("#jmlcetakbox6").keypress(validateNumber),$("#ketbox6").keyup(function(){$(".btn").prop("disabled",""==this.value)})}),$(".btnon, .btnd, .btnp").on("hidden.bs.modal",function(){$(this).removeData("bs.modal")}),$("#jmlcetakbox6").blur(function(){""==$(this).val()||"0"==$(this).val()?$(".jml").removeClass("has-success").addClass("has-danger"):($(".jml").removeClass("has-danger").addClass("has-success"),$("#not1").removeClass("blink-bg"))}),$("#lbrcetakbox6").blur(function(){""==$(this).val()||"0"==$(this).val()?$(".lbrcetakbox6").removeClass("has-success").addClass("has-danger"):$(".lbrcetakbox6").removeClass("has-danger").addClass("has-success")}),$("#pjcetakbox6").blur(function(){""==$(this).val()||"0"==$(this).val()?$(".pjcetakbox6").removeClass("has-success").addClass("has-danger"):$(".pjcetakbox6").removeClass("has-danger").addClass("has-success")}),$("#idmesin").change(function(){""==$(this).val()||"0"==$(this).val()?$(".idmesin").removeClass("has-success").addClass("has-danger"):($(".idmesin").removeClass("has-danger").addClass("has-success"),$("#not3").removeClass("blink-bg"))}),$("#ukuranp").change(function(){""==$(this).val()||0==$(this).val()?$(".ukuranp").removeClass("has-success").addClass("has-danger"):($(".ukuranp").removeClass("has-danger").addClass("has-success"),$(".lbrcetakp").removeClass("has-danger").addClass("has-success"),$(".tgcetakp").removeClass("has-danger").addClass("has-success"))}),$("#bahanbox6").change(function(){""==$(this).val()||"0"==$(this).val()?($(".bahanbox6").removeClass("has-success").addClass("has-danger"),$(".idkertas").removeClass("has-success").addClass("has-danger")):($(".bahanbox6").removeClass("has-danger").addClass("has-success"),$(".idkertas").removeClass("has-danger").addClass("has-success"),$("#not4").removeClass("blink-bg"))}),$("#ketbox6").blur(function(){""==$(this).val()?$(".ketbox6").removeClass("has-success").addClass("has-danger"):$(".ketbox6").removeClass("has-danger").addClass("has-success")}),$(document).ready(function(){$("#lbrcetakbox6").val("18"),$("#tgtutupatasbox6").val("2"),$("#tgtutupbawahbox6").val("8"),$("#pjcetakbox6").val("18"),$("#bbbox6").val("1"),$("#lbrtutupbox6").val("1.5"),$("#lbrdimensi4").val("0.5"),$(".gabungcetakbox6").hide(),$(".tutupbawah").hide(),$("#bx6").click(function(){$("#detailbox6").length&&$("#detailbox6").remove()})}),$("#tutupboxbawahbox6").click(function(){$("#tutupboxbawahbox6").attr("checked")?($("#tutupboxbawahbox6").attr("checked",!1),$("#gabungcetakbox6").prop("checked",!0),$(".gabungcetakbox6").show()):($("#tutupboxbawahbox6").attr("checked","checked"),$(".gabungcetakbox6").hide(),$(".tutupbawah").hide())}),$("#gabungcetakbox6").click(function(){$("#gabungcetakbox6").attr("checked")?($("#gabungcetakbox6").attr("checked",!1),$(".tutupbawah").show()):($("#gabungcetakbox6").attr("checked","checked"),$(".tutupbawah").hide())}),$("#idmesin").filter(function(){$("select[data-mesin]").each(function(){var a=$(this);a.append('<option value="0">Pilih mesin</option>'),$.ajax({url:a.attr("data-mesin")}).then(function(t){t.map(function(t){var e=$("<option>");e.val(t[a.attr("data-valueKey")]).text(t[a.attr("data-displayKey")]),a.append(e)})})})}),$("#idmesinb").filter(function(){$("select[data-mesinb]").each(function(){var a=$(this);a.append('<option value="0">Pilih mesin bawah</option>'),$.ajax({url:a.attr("data-mesinb")}).then(function(t){t.map(function(t){var e=$("<option>");e.val(t[a.attr("data-valueKeys")]).text(t[a.attr("data-displayKeys")]),a.append(e)})})})}),$("#bahanbox6").change(function(){var a=$(this).val();$.ajax({url:host+"/kertas/",type:"post",data:{depart:a,app_id:app_id},dataType:"json",success:function(a){var t=a.length;$("#idkertas").empty();for(var e=0;e<t;e++){var n=a[e].id,s=a[e].name;$("#idkertas").append("<option value='"+n+"'>"+s+"</option>")}}})}),$("#bahanbox6").filter(function(){$("select[data-source]").each(function(){var a=$(this);a.append('<option value="0">Pilih kertas</option>'),$.ajax({url:a.attr("data-source")}).then(function(t){t.map(function(t){var e=$("<option>");e.val(t[a.attr("data-valueKey")]).text(t[a.attr("data-displayKey")]),a.append(e)})})})}),$("#bahanbawahbox6").filter(function(){$("select[data-bawah]").each(function(){var a=$(this);a.append('<option value="0">Pilih kertas bawah</option>'),$.ajax({url:a.attr("data-bawah")}).then(function(t){t.map(function(t){var e=$("<option>");e.val(t[a.attr("data-valueKeys")]).text(t[a.attr("data-displayKeys")]),a.append(e)})})})}),$("#bahanbawahbox6").change(function(){var a=$(this).val();$.ajax({url:host+"/kertas/",type:"post",data:{depart:a,app_id:app_id},dataType:"json",success:function(a){var t=a.length;$("#idkertasb").empty();for(var e=0;e<t;e++){var n=a[e].id,s=a[e].name;$("#idkertasb").append("<option value='"+n+"'>"+s+"</option>")}}})}),$("#cekukuran"+mod).click(function(){CustomStyle();var a=$("#jmlcetak"+mod).val(),t=$("#lbrcetak"+mod).val(),e=$("#pjcetak"+mod).val(),n=$("#idmesin").val(),s=$("#bahan"+mod).val(),i=$("#jmlwarnabox61").val();if(""==a||"0"==a)salert("warning","Oops...",iMsg.J);else if(""==t||0==t)salert("warning","Oops...",iMsg.L);else if(""==e||0==e)salert("warning","Oops...",iMsg.T);else if(""==i||0==i)salert("warning","Oops...",iMsg.W);else if(0==n)salert("warning","Oops...",iMsg.M);else if(0==s)salert("warning","Oops...",iMsg.B);else{move();var o=document.getElementById("lbrcetak"+mod).value,l=document.getElementById("tgtutupatas"+mod).value,d=document.getElementById("tgtutupbawah"+mod).value;if(o>(r=document.getElementById("pjcetak"+mod).value)){o=document.getElementById("pjcetak"+mod).value;var r=document.getElementById("lbrcetak"+mod).value}lbrcetak=2*parseFloat(l)+parseFloat(o),tgcetak=2*parseFloat(l)+parseFloat(r),lbrcetak2=2*parseFloat(d)+parseFloat(o),tgcetak2=2*parseFloat(d)+parseFloat(r),1==document.getElementById("tutupboxbawah"+mod).checked?bawah=0:1==document.getElementById("gabungcetak"+mod).checked?(bawah=1,tgcetak>tgcetak2?tinggicetakan=tgcetak:tinggicetakan=tgcetak2,lebarcetakan=lbrcetak+lbrcetak2,lbrcetak=lebarcetakan,tgcetak=tinggicetakan):bawah=0,$.ajax({url:host+"/cek/cekukuran/",type:"POST",data:{mesin:n,lbrcetak:lbrcetak,tgcetak:tgcetak,app_id:app_id},dataType:"json",beforeSend:function(){$("#not1").removeClass("blink-bg")},success:function(a){"N"==a[0].toString()?alertx("Ukuran Kebesaran"):(move(),hitungbox6(lbrcetak,tgcetak,lbrcetak2,tgcetak2,bawah))}})}});
</script>
<?php
} //end token
else {
	echo json_encode(array(404 => "error"));
}
?>